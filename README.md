# kkh plugin for Obsidian

旧字旧仮名と新字新仮名とを相互に変換するツール kkh を Obsidian に移植したプラグインです。

## 機能

エディタ上で選択された文字列に対して任意の変換を行います。変換の種類は次の 6 種類です。

- 新仮名遣いから旧仮名遣いへ
- 旧仮名遣いから新仮名遣いへ
- 新漢字から旧漢字へ
- 旧漢字から新漢字へ
- 新字新仮名遣いから旧字旧仮名遣いへ
- 旧字旧仮名遣いから新字新仮遣いへ

## 使い方

Obsidian はマルチプラットフォーム・マルチデバイスで利用することができますが、デバイスの種類によって操作方法が若干異なります。

このため、ここでは各デバイスに分けて説明します。なお、動作確認は macOS, iPadOS, iOS でしていますが、Linux, Windows, Android 等も同様な操作になります[^1]。

[^1]: なると思います。Chrome ベースなのでショートカットキーの差異程度ではないかと。

### macOS (Linux, Windows?)

変換方法は 3 つあります。変換対象の文字列を選択してから

1. 左側のリボンにサイコロアイコンがありますので、そこから望む変換を選択します。

2. 左側のリボンからコマンドパレットを呼び出し、"kkh" と入力するとコマンド候補が絞られますので、そこから望む変換を選択します。

3. 右上にあるテキストメニュー(…)から望む変換を選択します。

デスクトップ版では 1. の方法が使いやすいと思います。

### iPadOS (Android?)

変換方法は 4 つあります。変換対象の文字列を選択してから

1. 左側のリボンにサイコロアイコンがありますので、そこから望む変換を選択します。

2. 左側のリボンからコマンドパレットを呼び出し、"kkh" と入力するとコマンド候補が絞られますので、そこから望む変換を選択します。

3. 右上にあるテキストメニュー(…)から望む変換を選択します。

4. 下側に表示されるツールバーから望む変換を選択します。ただしこれは、ツールバーの設定で kkh の機能を追加した場合です。ツールバーがごちゃごちゃしてしまうので推奨できません。

タブレット版では 3. の方法が使いやすいと思います。

### iOS (Android?)

変換方法は 3 つあります。変換対象の文字列を選択してから

1. 下側のハンバーガーメニュー(三)から kkh メニューを選択し、そこから望む変換を選択します。
キーボードを隠さないとハンバーガーメニューが見えないのでひと手間かかります。

2. 下側のハンバーガーメニュー(三)からコマンドパレットを呼び出し、"kkh" と入力するとコマンド候補が絞られますので、そこから望む変換を選択します。これもひと手間かかります。

3. 右上にあるテキストメニュー(…)から望む変換を選択します。メニューの下部にあるため、スワイプする手間がかかります。

スマートフォン版では 3. の方法が若干使いやすいと思います。しかし、画面が小さく、また画面の切替はストレスに感じるので、スマートフォンでの利用は推奨できません。

## インストール方法

### 手動にて

[公式サイト](https://docs.obsidian.md/Plugins/Getting+started/Build+a+plugin)の手順書に従って "main.js" を生成します。公式では Vault フォルダにリポジトリを clone するようになっていますが、iCloud を利用している場合には注意が必要です。100MB を超える `node_modules` が同期されてしまうため、貴重なデータ通信量(いわゆるギガ)を消費してしまいます。また、iCloud の容量も圧迫してしまいます。

ここではホームディレクトリで生成して Vault フォルダに必要なものをコピーする方法を記述します。なお、最低限 Node.js が必要です。

コマンドプロンプトにて

```sh
cd $HOME
git clone https://github.com/okikae/obsidian-kkh.git
cd obsidian-kkh
npm install
npm run build
```

これで "main.js" ファイルが生成されました。`git clone` の部分は、'git' コマンドが無い場合、このリポジトリを zip でダウンロードすれば良いです(解凍してその中に移動)。

Vault フォルダ以下に ".obsidian/plugins/obsidian-kkh" フォルダを作成し、そこに "main.js", "manifest.json" をコピーします。

わたしは macOS, iPadOS, iOS で共有するために iCloud を利用しています。このため、Vault フォルダを "$HOME/Library/Mobile Documents/iCloud~md~obsidian/Documents
" 以下に置いています。

例えば Vault フォルダを「雑記」とします。このときプラグインは下記のように配置して Obsidian で設定すると利用可能になります。

```
$HOME/Library/Mobile Documents/iCloud~md~obsidian/Documents/雑記/.obsidian/plugins/obsidian-kkh/main.js
$HOME/Library/Mobile Documents/iCloud~md~obsidian/Documents/雑記/.obsidian/plugins/obsidian-kkh/manifest.js
```

Windows ではエクスプローラーでフォルダを作成していって、上記の 2 ファイルをコピーすれば良いと思います(ドットフォルダが不可視になるのかわかりませんけど)。

Obsidian での設定は、"Preference..." -> "Community Plugins" -> "Installed plugins" で有効にすれば完了です。

### 公式サイトのコミュニティープラグインから

「Preferences...」->「Community Plugins」で Browse ボタンを押すとプラグイン一覧が表示されるので、"kkh" を検索します。現在はまだ申請していませんので、この方法ではインストールすることはできません。お待ちください。

## その他

内包している辞書データは、[kkh](https://github.com/okikae/kkh) による活動の成果を利用しています。辞書が「キモ」なのです。
